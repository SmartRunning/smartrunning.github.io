"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2030],{1834:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"architecture/authentication","title":"Authentication","description":"Overview","source":"@site/docs/architecture/authentication.md","sourceDirName":"architecture","slug":"/architecture/authentication","permalink":"/docs/architecture/authentication","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/architecture/authentication.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Authentication"},"sidebar":"tutorialSidebar","previous":{"title":"Data Flow","permalink":"/docs/architecture/data-flow"},"next":{"title":"Deployment","permalink":"/docs/architecture/deployment"}}');var s=r(4848),t=r(8453);const l={sidebar_position:4,title:"Authentication"},o="Authentication",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Authentication System",id:"authentication-system",level:2},{value:"User Roles &amp; Permissions",id:"user-roles--permissions",level:2},{value:"User-Runner Integration",id:"user-runner-integration",level:2},{value:"Onboarding Workflow",id:"onboarding-workflow",level:2},{value:"User Creation Workflows",id:"user-creation-workflows",level:2},{value:"Route Protection",id:"route-protection",level:2},{value:"Security Implementation",id:"security-implementation",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"authentication",children:"Authentication"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.p,{children:["The application implements a comprehensive role-based access control (RBAC) system with three user roles: ",(0,s.jsx)(n.strong,{children:"Admin"}),", ",(0,s.jsx)(n.strong,{children:"Coach"}),", and ",(0,s.jsx)(n.strong,{children:"Runner"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"authentication-system",children:"Authentication System"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Architecture"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Provider-based"}),": Extensible authentication provider architecture"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Local Authentication"}),": Bcrypt password hashing (cost factor 12)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Session Management"}),": Flask-Login for session handling"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Rate Limiting"}),": 50 login attempts per 15 minutes (configurable)"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Components"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"app/auth/providers/"})," - Authentication provider implementations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"app/auth/user.py"})," - User model with Flask-Login integration"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"app/auth/routes.py"})," - Login/logout/profile endpoints"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"app/auth/permissions.py"})," - Authorization decorators"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"user-roles--permissions",children:"User Roles & Permissions"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Role"}),(0,s.jsx)(n.th,{children:"Athletes Dashboard"}),(0,s.jsx)(n.th,{children:"Admin Dashboard"}),(0,s.jsx)(n.th,{children:"Runner Access"}),(0,s.jsx)(n.th,{children:"Create Athletes"}),(0,s.jsx)(n.th,{children:"User Management"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Admin"})}),(0,s.jsx)(n.td,{children:"Full access, all runners"}),(0,s.jsx)(n.td,{children:"Full access"}),(0,s.jsx)(n.td,{children:"All runners"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Full CRUD"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Coach"})}),(0,s.jsx)(n.td,{children:"Full access, assigned runners"}),(0,s.jsx)(n.td,{children:"Limited (Workouts & Schemas only)"}),(0,s.jsx)(n.td,{children:"Assigned runners only"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Cannot manage users"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Runner"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Auto-navigated to own view"})}),(0,s.jsx)(n.td,{children:"No access"}),(0,s.jsx)(n.td,{children:"Own profile only"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"No"})}),(0,s.jsx)(n.td,{children:"Profile edit only"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Multi-role Users"}),": Users with multiple roles (e.g., Coach + Runner) receive the highest level of access. A Coach who is also a Runner will have Coach-level access to the Athletes Dashboard."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Runner Auto-Navigation"}),": Pure runner users (those with only the runner role) are automatically redirected to their personal training view (",(0,s.jsx)(n.code,{children:"/#/runner/{id}/info/"}),') upon login, bypassing the Athletes Dashboard entirely. They cannot navigate back to the dashboard and do not see the "Add New Athlete" card.']}),"\n",(0,s.jsx)(n.h2,{id:"user-runner-integration",children:"User-Runner Integration"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Data Model"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Users Collection\n{\n  _id: ObjectId,\n  username: String (unique),\n  email: String (unique),\n  password_hash: String (bcrypt),\n  roles: [String],              // ["admin", "coach", "runner"]\n  runner_id: ObjectId,           // Links to runner profile (if runner role)\n  coached_runners: [ObjectId],   // Array of runner IDs (if coach role)\n  is_active: Boolean,\n  created_at: DateTime,\n  last_login: DateTime\n}\n\n// Runner Collection\n{\n  _id: ObjectId,\n  runnerID: String,              // Legacy string ID\n  name: String,\n  email: String,\n  profile_complete: Boolean,     // Flags incomplete profiles for onboarding\n  // ... training data fields ...\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Relationship"}),": One-way link from ",(0,s.jsx)(n.code,{children:"users.runner_id"})," \u2192 ",(0,s.jsx)(n.code,{children:"runner._id"})]}),"\n",(0,s.jsx)(n.h2,{id:"onboarding-workflow",children:"Onboarding Workflow"}),"\n",(0,s.jsx)(n.p,{children:"New runner users go through a 4-step onboarding wizard:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Basic Info"}),": Name, age"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Heart Rate Zones"}),": 5 HR zones with automatic calculation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Personal Bests"}),": Multiple distances with performance metric calculation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Training Parameters"}),": Physiological model parameters"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Implementation"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["First login detects ",(0,s.jsx)(n.code,{children:"profile_complete: false"})," and redirects to ",(0,s.jsx)(n.code,{children:"/onboarding"})]}),"\n",(0,s.jsx)(n.li,{children:'Onboarding form matches "Add New Athlete" wizard format'}),"\n",(0,s.jsxs)(n.li,{children:["After completion, redirects to runner detail page via hash route ",(0,s.jsx)(n.code,{children:"/#/runner/{id}/info/"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"user-creation-workflows",children:"User Creation Workflows"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Workflow 1: Admin creates runner user"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Admin \u2192 User Management \u2192 Create User (runner role)\n  \u2193\nUser account created\n  \u2193\nRunner profile auto-created with profile_complete: false\n  \u2193\nRunner logs in \u2192 Redirected to onboarding\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Workflow 2: Coach creates athlete"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Coach \u2192 Add New Athlete \u2192 Complete 4-step wizard\n  \u2193\nRunner profile created\n  \u2193\nOptional: Create user account (Step 5)\n  \u2193\nIf yes: User account created and linked\n  \u2193\nCoach auto-assigned to runner\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Workflow 3: Migration of existing data"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Migration script \u2192 Analyze orphaned users/runners\n  \u2193\nAuto-create missing runner profiles or user accounts\n  \u2193\nLink by email matching\n  \u2193\nFlag incomplete profiles for onboarding\n"})}),"\n",(0,s.jsx)(n.h2,{id:"route-protection",children:"Route Protection"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Decorators"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"@login_required"})," - Requires authenticated user"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"@admin_only"})," - Admin role required"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"@coach_or_admin"})," - Coach or Admin role required"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"@role_required('role_name')"})," - Custom role requirement"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Permission Filtering"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/runners"})," endpoint returns filtered results based on role"]}),"\n",(0,s.jsx)(n.li,{children:"Runners only see their own profile"}),"\n",(0,s.jsx)(n.li,{children:"Coaches only see assigned runners"}),"\n",(0,s.jsx)(n.li,{children:"Admins see all runners"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"security-implementation",children:"Security Implementation"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Password Security"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Bcrypt hashing with cost factor 12"}),"\n",(0,s.jsx)(n.li,{children:"Password strength validation (8+ chars, uppercase, lowercase, digit, special)"}),"\n",(0,s.jsx)(n.li,{children:"Password change requires current password verification"}),"\n",(0,s.jsx)(n.li,{children:"Last admin protection (cannot remove admin role from last admin user)"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Session Security"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Flask-Login session management"}),"\n",(0,s.jsx)(n.li,{children:"Secure session cookies"}),"\n",(0,s.jsx)(n.li,{children:"Rate limiting on login endpoint"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Input Validation"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Username validation (3-30 chars, alphanumeric + underscore)"}),"\n",(0,s.jsx)(n.li,{children:"Email validation"}),"\n",(0,s.jsx)(n.li,{children:"Role validation against allowed roles"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"API Security"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"All routes require authentication"}),"\n",(0,s.jsx)(n.li,{children:"Role-based authorization on sensitive endpoints"}),"\n",(0,s.jsx)(n.li,{children:"401/403 error pages for unauthorized access"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Data Protection"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"MongoDB connections via SSL/TLS"}),"\n",(0,s.jsx)(n.li,{children:"Environment variables for sensitive configuration"}),"\n",(0,s.jsx)(n.li,{children:"Certificate management via certifi package"}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>o});var i=r(6540);const s={},t=i.createContext(s);function l(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);