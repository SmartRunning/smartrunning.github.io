"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9425],{8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>c});var r=i(6540);const s={},l=r.createContext(s);function t(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(l.Provider,{value:n},e.children)}},9096:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"architecture/deployment","title":"Deployment","description":"Performance Considerations","source":"@site/docs/architecture/deployment.md","sourceDirName":"architecture","slug":"/architecture/deployment","permalink":"/docs/architecture/deployment","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/architecture/deployment.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Deployment"},"sidebar":"tutorialSidebar","previous":{"title":"Authentication","permalink":"/docs/architecture/authentication"},"next":{"title":"Time Series","permalink":"/docs/architecture/time-series"}}');var s=i(4848),l=i(8453);const t={sidebar_position:5,title:"Deployment"},c="Deployment",o={},a=[{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Current Optimizations",id:"current-optimizations",level:3},{value:"Performance Characteristics",id:"performance-characteristics",level:3},{value:"Deployment Architecture",id:"deployment-architecture",level:2},{value:"Local Development with Docker Compose",id:"local-development-with-docker-compose",level:3},{value:"Production Kubernetes Deployment",id:"production-kubernetes-deployment",level:3},{value:"Kubernetes Resources",id:"kubernetes-resources",level:4},{value:"Deployment Features",id:"deployment-features",level:4},{value:"Production State",id:"production-state",level:3},{value:"API Design",id:"api-design",level:2},{value:"RESTful Principles",id:"restful-principles",level:3},{value:"Key Endpoints",id:"key-endpoints",level:3},{value:"Development Workflow",id:"development-workflow",level:2},{value:"Code Organization",id:"code-organization",level:3},{value:"SSL/TLS Architecture",id:"ssltls-architecture",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"deployment",children:"Deployment"})}),"\n",(0,s.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,s.jsx)(n.h3,{id:"current-optimizations",children:"Current Optimizations"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Database Indexing"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Indexes on runner_id, session_id fields"}),"\n",(0,s.jsx)(n.li,{children:"Compound indexes for query optimization"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"File Processing"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Duplicate detection via file hashing"}),"\n",(0,s.jsx)(n.li,{children:"Batch processing for multiple files"}),"\n",(0,s.jsx)(n.li,{children:"GridFS for efficient binary storage"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Caching Strategy"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Session statistics cached after calculation"}),"\n",(0,s.jsx)(n.li,{children:"Personal bests updated incrementally"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"performance-characteristics",children:"Performance Characteristics"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Large File Processing"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"FIT file parsing is CPU-intensive"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Statistics Calculation"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Complex calculations for large datasets"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Training Plan Generation"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Synchronous processing for complex plans"}),"\n",(0,s.jsx)(n.li,{children:"Background job implementation available"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"deployment-architecture",children:"Deployment Architecture"}),"\n",(0,s.jsx)(n.p,{children:"The application supports multiple deployment strategies for different environments:"}),"\n",(0,s.jsx)(n.h3,{id:"local-development-with-docker-compose",children:"Local Development with Docker Compose"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'services:\n  web:\n    build: .\n    ports:\n      - "[external_port]:5000"\n    volumes:\n      - ./app:/app/app\n      - ./data:/app/data\n    environment:\n      - FLASK_ENV=development\n    networks:\n      - running-network\n'})}),"\n",(0,s.jsx)(n.h3,{id:"production-kubernetes-deployment",children:"Production Kubernetes Deployment"}),"\n",(0,s.jsx)(n.p,{children:"The application includes a complete Kubernetes CI/CD pipeline for Google Cloud Platform deployment:"}),"\n",(0,s.jsx)(n.h4,{id:"kubernetes-resources",children:"Kubernetes Resources"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["Deployment Configuration (",(0,s.jsx)(n.code,{children:"deployment.yml"}),")"]}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: smartrunning-localapp\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: smartrunning-localapp\n  template:\n    spec:\n      containers:\n      - name: app\n        image: LOCATION-docker.pkg.dev/PROJECT_ID/REPOSITORY/IMAGE:TAG\n        ports:\n        - containerPort: 5000\n        resources:\n          requests:\n            cpu: "250m"\n            memory: "512Mi"\n          limits:\n            cpu: "1000m"\n            memory: "2Gi"\n        env:\n        - name: FLASK_ENV\n          value: "production"\n        - name: MONGO_CONNECTION_STRING\n          value: "mongodb+srv://..."\n        - name: SSL_CERT_FILE\n          value: "/etc/ssl/certs/ca-certificates.crt"\n        - name: REQUESTS_CA_BUNDLE\n          value: "/etc/ssl/certs/ca-certificates.crt"\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["Service Configuration (",(0,s.jsx)(n.code,{children:"service.yml"}),")"]}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Service\nmetadata:\n  name: smartrunning-localapp-service\nspec:\n  type: LoadBalancer\n  selector:\n    app: smartrunning-localapp\n  ports:\n  - port: 8347\n    targetPort: 5000\n    protocol: TCP\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["Kustomization (",(0,s.jsx)(n.code,{children:"kustomization.yaml"}),")"]}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: kustomize.config.k8s.io/v1beta1\nkind: Kustomization\nresources:\n- deployment.yml\n- service.yml\nimages:\n- name: LOCATION-docker.pkg.dev/PROJECT_ID/REPOSITORY/IMAGE:TAG\n  newName: LOCATION-docker.pkg.dev/PROJECT_ID/REPOSITORY/IMAGE\n  newTag: TAG\n"})}),"\n",(0,s.jsx)(n.h4,{id:"deployment-features",children:"Deployment Features"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Container Orchestration"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Kubernetes deployment with 2 replicas for high availability"}),"\n",(0,s.jsx)(n.li,{children:"LoadBalancer service for external access"}),"\n",(0,s.jsx)(n.li,{children:"Automatic container restart and health monitoring"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Google Cloud Integration"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Container images stored in Google Artifact Registry"}),"\n",(0,s.jsx)(n.li,{children:"Deployment via Google Kubernetes Engine (GKE)"}),"\n",(0,s.jsx)(n.li,{children:"SSL termination and load balancing"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"SSL/TLS Configuration"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Docker image includes ca-certificates and openssl packages"}),"\n",(0,s.jsx)(n.li,{children:"Certifi Python package for SSL certificate management"}),"\n",(0,s.jsx)(n.li,{children:"Proper SSL context creation for MongoDB connections"}),"\n",(0,s.jsx)(n.li,{children:"Environment variables for SSL certificate paths"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Environment Management"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Production environment variables"}),"\n",(0,s.jsx)(n.li,{children:"Secure database connection strings"}),"\n",(0,s.jsx)(n.li,{children:"Configurable resource limits"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"production-state",children:"Production State"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Scaling"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Horizontal scaling via Kubernetes replicas"}),"\n",(0,s.jsx)(n.li,{children:"LoadBalancer distributes traffic across pods"}),"\n",(0,s.jsx)(n.li,{children:"Auto-scaling capabilities available"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Monitoring"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Kubernetes health checks and restart policies"}),"\n",(0,s.jsx)(n.li,{children:"Container resource monitoring"}),"\n",(0,s.jsx)(n.li,{children:"Application performance monitoring available via GCP"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Backup"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"MongoDB Atlas automated backups"}),"\n",(0,s.jsx)(n.li,{children:"GridFS data replication"}),"\n",(0,s.jsx)(n.li,{children:"Kubernetes configuration stored in version control"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"api-design",children:"API Design"}),"\n",(0,s.jsx)(n.h3,{id:"restful-principles",children:"RESTful Principles"}),"\n",(0,s.jsx)(n.p,{children:"The API follows REST conventions:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Resources"}),": ",(0,s.jsx)(n.code,{children:"/runners"}),", ",(0,s.jsx)(n.code,{children:"/sessions"}),", ",(0,s.jsx)(n.code,{children:"/workouts"}),", ",(0,s.jsx)(n.code,{children:"/training-plans"}),", ",(0,s.jsx)(n.code,{children:"/calculate_critical_speed"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"HTTP Methods"}),": GET, POST, PUT, DELETE"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Status Codes"}),": Proper HTTP status codes (200, 201, 400, 404, 500)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"JSON Responses"}),": Consistent response format"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"key-endpoints",children:"Key Endpoints"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"POST /calculate_performance_metrics"})," - Calculate performance metrics from personal best times"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Input: Personal best times for multiple distances"}),"\n",(0,s.jsx)(n.li,{children:"Output: Performance metric values and statistical quality indicators"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"POST /calculate_heart_rate_zones"})," - Calculate heart rate zones based on age using HUNT formula"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Input: ",(0,s.jsx)(n.code,{children:"age"})," (integer, 1-120)"]}),"\n",(0,s.jsxs)(n.li,{children:["Output: ",(0,s.jsx)(n.code,{children:"max_heart_rate"}),", ",(0,s.jsx)(n.code,{children:"zones"})," (hr_zone_1_max through hr_zone_5_max), ",(0,s.jsx)(n.code,{children:"age"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"development-workflow",children:"Development Workflow"}),"\n",(0,s.jsxs)(n.p,{children:["For local development setup and commands, see ",(0,s.jsx)(n.a,{href:"/docs/overview",children:"Platform Overview"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"code-organization",children:"Code Organization"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"app/\n\u251c\u2500\u2500 Core Application\n\u2502   \u251c\u2500\u2500 __init__.py    # App factory\n\u2502   \u251c\u2500\u2500 config.py      # Configuration\n\u2502   \u2514\u2500\u2500 routes.py      # API endpoints\n\u251c\u2500\u2500 Data Layer\n\u2502   \u251c\u2500\u2500 database.py    # DB operations\n\u2502   \u2514\u2500\u2500 models.py      # Data models\n\u251c\u2500\u2500 Service Layer\n\u2502   \u251c\u2500\u2500 file_processor.py\n\u2502   \u251c\u2500\u2500 statistics_processor.py\n\u2502   \u2514\u2500\u2500 training_plan_generator.py\n\u2514\u2500\u2500 Utilities\n    \u251c\u2500\u2500 defaults.py    # Default values\n    \u2514\u2500\u2500 job_manager.py # Background tasks\n"})}),"\n",(0,s.jsx)(n.h2,{id:"ssltls-architecture",children:"SSL/TLS Architecture"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Certificate Management"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Docker layer includes ca-certificates and openssl packages"}),"\n",(0,s.jsx)(n.li,{children:"Certifi package provides up-to-date CA certificate bundle"}),"\n",(0,s.jsx)(n.li,{children:"SSL context created with proper certificate validation"}),"\n",(0,s.jsx)(n.li,{children:"Environment variables for certificate paths (SSL_CERT_FILE, REQUESTS_CA_BUNDLE)"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["For SSL/TLS troubleshooting, see the ",(0,s.jsx)(n.a,{href:"/docs/storage/mongodb-setup",children:"MongoDB Setup Guide"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);